<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galapagos Logistics - API GraphQL</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-4xl font-bold text-blue-600 mb-2">üèùÔ∏è Galapagos Logistics</h1>
        <p class="text-gray-600 mb-8">Interface de visualisation GraphQL</p>

        <!-- Navigation simple -->
        <div class="flex gap-2 mb-6">
            <button onclick="charger('hydravions')" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Hydravions</button>
            <button onclick="charger('clients')" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">Clients</button>
            <button onclick="charger('commandes')" class="px-4 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">Commandes</button>
            <button onclick="charger('iles')" class="px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600">√éles</button>
            <button onclick="charger('produits')" class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">Produits</button>
        </div>

        <!-- Zone d'affichage -->
        <div id="resultats" class="bg-white rounded-lg shadow p-6">
            <p class="text-gray-500">Cliquez sur un bouton pour afficher les donn√©es</p>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:8001/graphql';

        async function graphql(query) {
            const res = await fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ query })
            });
            const data = await res.json();
            return data.data;
        }

        async function charger(type) {
            const queries = {
                hydravions: `{ hydravions { id nom modele statut capacite_caisses port_actuel } }`,
                clients: `{ clients { id nom prenom email role organisation ile_principale } }`,
                commandes: `{ commandes { id port_destination statut priorite nombre_caisses_requises client { nom prenom } } }`,
                iles: `{ iles { nom superficie population description coordonnees { latitude longitude } } }`,
                produits: `{ produits { id nom categorie poids stock_disponible } }`
            };

            const data = await graphql(queries[type]);
            afficher(type, data[type]);
        }

        function afficher(type, items) {
            const div = document.getElementById('resultats');

            if (!items || items.length === 0) {
                div.innerHTML = '<p class="text-gray-500">Aucune donn√©e</p>';
                return;
            }

            const templates = {
                hydravions: h => `
                    <div class="border p-4 rounded mb-2">
                        <h3 class="font-bold">${h.nom}</h3>
                        <p class="text-sm text-gray-600">Mod√®le: ${h.modele} | Statut: ${h.statut}</p>
                        <p class="text-sm text-gray-600">Capacit√©: ${h.capacite_caisses} caisses</p>
                    </div>`,

                clients: c => `
                    <div class="border p-4 rounded mb-2">
                        <h3 class="font-bold">${c.prenom} ${c.nom}</h3>
                        <p class="text-sm text-gray-600">${c.role} - ${c.organisation}</p>
                        <p class="text-sm text-gray-600">√éle: ${c.ile_principale} | Email: ${c.email}</p>
                    </div>`,

                commandes: cmd => `
                    <div class="border p-4 rounded mb-2">
                        <h3 class="font-bold">Commande ‚Üí ${cmd.port_destination}</h3>
                        <p class="text-sm text-gray-600">Client: ${cmd.client ? cmd.client.prenom + ' ' + cmd.client.nom : 'N/A'}</p>
                        <p class="text-sm text-gray-600">Statut: ${cmd.statut} | Priorit√©: ${cmd.priorite} | Caisses: ${cmd.nombre_caisses_requises}</p>
                    </div>`,

                iles: i => `
                    <div class="border p-4 rounded mb-2">
                        <h3 class="font-bold">üèùÔ∏è ${i.nom}</h3>
                        <p class="text-sm text-gray-600">${i.description}</p>
                        <p class="text-sm text-gray-600">Superficie: ${i.superficie} km¬≤ | Population: ${i.population || 0}</p>
                        <p class="text-sm text-gray-600">Coords: ${i.coordonnees.latitude.toFixed(2)}, ${i.coordonnees.longitude.toFixed(2)}</p>
                    </div>`,

                produits: p => `
                    <div class="border p-4 rounded mb-2">
                        <h3 class="font-bold">${p.nom}</h3>
                        <p class="text-sm text-gray-600">Cat√©gorie: ${p.categorie}</p>
                        <p class="text-sm text-gray-600">Poids: ${p.poids} kg | Stock: ${p.stock_disponible}</p>
                    </div>`
            };

            div.innerHTML = `
                <h2 class="text-2xl font-bold mb-4">${type.charAt(0).toUpperCase() + type.slice(1)} (${items.length})</h2>
                ${items.map(templates[type]).join('')}
            `;
        }
    </script>
</body>
</html>
